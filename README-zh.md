# n8n-nodes-alicloud-file-transcription

[![English](https://img.shields.io/badge/English-Click-yellow)](README.md)
[![中文文档](https://img.shields.io/badge/中文文档-点击查看-orange)](README-zh.md)

这是一个n8n社区节点，让您可以在n8n工作流中使用阿里云智能语音服务进行文件转录。

阿里云智能语音服务提供高精度的语音识别能力，支持多种音频格式的文件转录。通过这个节点，您可以轻松将音频文件转换为文本，并将其集成到您的自动化工作流中。

[n8n](https://n8n.io/) 是一个[公平代码许可](https://docs.n8n.io/reference/license/)的工作流自动化平台。

[安装](#安装)  
[操作](#操作)  
[凭据](#凭据)  
[兼容性](#兼容性)  
[使用说明](#使用说明)  
[资源](#资源)  
[版本历史](#版本历史)  

## 安装

按照n8n社区节点文档中的[安装指南](https://docs.n8n.io/integrations/community-nodes/installation/)进行安装。

另外，你也可以参考使用这些[n8n工作流模板](https://github.com/crazyyanchao/n8n-workflow-template)。

## 操作

此节点支持以下操作：

- **文件转录（完整工作流）**: 自动处理任务提交和结果轮询的完整流程（推荐）
- **仅提交任务**: 只提交转录任务，不等待结果
- **仅查询结果**: 查询已提交任务的转录结果

## 凭据

要使用此节点，您需要：

1. **注册阿里云账户**: 访问 [阿里云官网](https://www.aliyun.com/) 注册账户
2. **开通智能语音服务**: 在阿里云控制台开通智能语音服务
3. **获取访问密钥**: 在RAM控制台创建AccessKey ID和AccessKey Secret
4. **获取AppKey**: 在智能语音服务控制台获取项目AppKey
5. **配置凭据**: 在n8n中配置阿里云文件转录凭据

### 认证方法
- **AccessKey认证**: 使用阿里云AccessKey ID和Secret进行API调用
- **AppKey认证**: 使用智能语音服务项目的AppKey

## 兼容性

- **最低n8n版本**: 1.0.0
- **Node.js版本**: >=22.16
- **测试版本**: n8n 1.0.0+

## 使用说明

### 基本配置

1. **添加阿里云文件转录节点**到您的工作流中
2. **配置凭据**: 选择或创建阿里云文件转录API凭据
3. **选择操作**: 选择文件转录操作类型
4. **输入文件链接**: 提供要转录的音频文件URL

### 操作类型详解

#### 1. 文件转录（完整工作流）- 推荐使用
- **功能**: 一键完成文件转录，自动处理所有内部流程
- **输入**: 文件链接
- **输出**: 完整的转录结果
- **特点**: 最简单易用，适合大多数场景

#### 2. 仅提交任务
- **功能**: 只提交转录任务，获得任务ID
- **输入**: 文件链接
- **输出**: 任务ID和提交状态
- **用途**: 批量提交任务或异步处理

#### 3. 仅查询结果
- **功能**: 查询指定任务的转录结果
- **输入**: 任务ID
- **输出**: 当前任务状态和结果
- **用途**: 配合"仅提交任务"使用

### 参数配置

#### 简单设置模式（推荐）
- **文件链接**: 要转录的音频文件URL
- **版本**: API版本（默认4.0）
- **启用词信息**: 是否输出词信息（默认false）
- **启用采样率自适应**: 是否启用采样率自适应（默认true）

#### 高级JSON配置模式
```json
{
  "appkey": "your_app_key",
  "file_link": "your_file_link",
  "version": "4.0",
  "enable_words": false,
  "enable_sample_rate_adaptive": true
}
```

### 轮询设置（仅完整工作流）
- **轮询间隔**: 查询结果的时间间隔（默认10秒）
- **最大轮询次数**: 防止无限等待（默认60次）

### 支持的文件格式

- **音频格式**: WAV, MP3, M4A, FLAC, AAC等
- **文件大小**: 建议不超过500MB
- **文件来源**: 支持HTTP/HTTPS链接

### 数据输出

节点将返回包含以下信息的JSON数据：

```json
{
  "success": true,
  "statusText": "SUCCESS",
  "taskId": "your_task_id",
  "result": {
    "sentences": [
      {
        "text": "转录的文本内容",
        "begin_time": 0,
        "end_time": 3000
      }
    ]
  },
  "pollCount": 5,
  "response": { /* 完整API响应 */ }
}
```

## 使用场景

### 场景1：简单文件转录
```
音频文件 → 文件转录节点（完整工作流）→ 转录结果
```

### 场景2：批量文件处理
```
文件列表 → 循环节点 → 文件转录节点（仅提交任务）→ 收集任务ID
任务ID列表 → 循环节点 → 文件转录节点（仅查询结果）→ 处理结果
```

### 场景3：异步处理
```
文件上传 → 文件转录节点（仅提交任务）→ 其他工作流操作
稍后 → 文件转录节点（仅查询结果）→ 获取转录结果
```

## 资源

* [n8n社区节点文档](https://docs.n8n.io/integrations/#community-nodes)
* [阿里云智能语音服务文档](https://help.aliyun.com/product/30413.html)
* [阿里云文件转录API参考](https://help.aliyun.com/document_detail/90727.html)

## 版本历史

### v0.1.0 (当前版本)
- 初始版本发布
- 支持完整的文件转录工作流
- 支持单独提交任务和查询结果
- 基于官方阿里云SDK实现
- 自动轮询机制
- 完整的错误处理

### 计划功能
- 支持更多音频格式
- 添加批量处理功能
- 优化大文件处理
- 增加转录质量配置选项

---

**注意**: 使用此节点需要有效的阿里云账户和智能语音服务权限。请确保遵守阿里云的使用条款和API调用限制。
